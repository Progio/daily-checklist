<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Break Habits</title>

<style>
:root{
  --bg:#121212;
  --card:#1e1e1e;
  --accent:#4CAF50;
  --text:#eee;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg);
  color:var(--text);
}

.container{
  max-width:520px;
  margin:auto;
  padding:16px;
}

.card{
  background:var(--card);
  padding:14px;
  border-radius:14px;
  margin-bottom:12px;
}

input, textarea{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #333;
  background:#1e1e1e;
  color:#eee;
  box-sizing:border-box;
  margin-bottom:10px;
}

button{
  padding:10px;
  border:none;
  border-radius:10px;
  margin:4px 0;
  font-weight:bold;
  cursor:pointer;
}

.primary{background:var(--accent);color:white;}
.secondary{background:#333;color:white;}
.danger{background:#a33;color:white;}

.small{font-size:13px;opacity:.8;}
.points{color:#8f8;font-size:13px;}

canvas{
  width:100%;
  background:#1e1e1e;
  border-radius:10px;
  margin-top:8px;
}
</style>
</head>

<body>
<div class="container">

<h2>üö´ Breaking Habits</h2>

<div class="card">
<input id="habitName" placeholder="Habit I'm quitting" />
<textarea id="habitWhy" placeholder="Why do you want to quit? (powerful for urges)"></textarea>
<button class="primary" onclick="addHabit()">Add Habit</button>
</div>

<label>
<input type="checkbox" id="faithToggle" onchange="toggleFaith()" />
Faith encouragement mode
</label>

<div id="encourage" class="card small" style="display:none;"></div>

<div id="habits"></div>

</div>

<script>
let habits = JSON.parse(localStorage.getItem("badHabits")||"[]");
let faithMode = JSON.parse(localStorage.getItem("faithMode")||"false");

const verses=[
"1 Cor 10:13 ‚Äî God provides a way out of temptation.",
"Phil 4:13 ‚Äî I can do all things through Christ.",
"Gal 6:9 ‚Äî Don‚Äôt grow weary doing good.",
"Psalm 34:17 ‚Äî The Lord hears and delivers.",
"2 Tim 1:7 ‚Äî God gave power, not fear."
];

document.getElementById("faithToggle").checked=faithMode;

function save(){
 localStorage.setItem("badHabits",JSON.stringify(habits));
 localStorage.setItem("faithMode",faithMode);
}

function toggleFaith(){
 faithMode=document.getElementById("faithToggle").checked;
 save();
}

function randomVerse(){
 return verses[Math.floor(Math.random()*verses.length)];
}

function showEncourage(text){
 const box=document.getElementById("encourage");
 box.style.display="block";
 box.innerHTML=text;
}

function addHabit(){
 const name=document.getElementById("habitName").value.trim();
 const why=document.getElementById("habitWhy").value.trim();

 if(!name) return;

 habits.push({
  name,
  why,
  streak:0,
  longest:0,
  slips:0,
  urges:0,
  points:0,
  history:[]
 });

 document.getElementById("habitName").value="";
 document.getElementById("habitWhy").value="";

 save();
 render();
}

function resisted(i){
 const h=habits[i];
 h.streak++;
 h.longest=Math.max(h.longest,h.streak);
 h.points+=10;
 h.history.push({s:h.streak,sl:h.slips});

 save();
 render();
}

function slipped(i){
 const h=habits[i];
 h.slips++;
 h.streak=0;
 h.history.push({s:h.streak,sl:h.slips});

 if(faithMode) showEncourage(randomVerse());
 save();
 render();
}

function urge(i){
 const h=habits[i];
 h.urges++;

 let msg="‚è≥ Urge logged. Wait 2 minutes.<br>"+h.why;
 if(faithMode) msg+="<br><br>"+randomVerse();

 showEncourage(msg);

 setTimeout(()=>{
  showEncourage("Urges pass. You're stronger than it.");
 },120000);

 save();
 render();
}

function deleteHabit(i){
 habits.splice(i,1);
 save();
 render();
}

function level(p){return Math.floor(p/100)+1;}

function drawChart(canvas,data){
 const ctx=canvas.getContext("2d");
 ctx.clearRect(0,0,canvas.width,canvas.height);

 ctx.beginPath();
 data.slice(-20).forEach((d,i)=>{
  ctx.lineTo(i*15,80-d.s*5);
 });
 ctx.stroke();
}

function render(){
 const container=document.getElementById("habits");
 container.innerHTML="";

 habits.forEach((h,i)=>{
 container.innerHTML+=`
 <div class="card">
 <b>${h.name}</b>
 <div class="small">üî• Streak: ${h.streak}</div>
 <div class="small">üèÜ Longest: ${h.longest}</div>
 <div class="small">‚ö†Ô∏è Slips: ${h.slips}</div>
 <div class="small">üß† Urges: ${h.urges}</div>
 <div class="points">‚≠ê Level ${level(h.points)} (${h.points} pts)</div>

 <button class="primary" onclick="resisted(${i})">Resisted Today</button>
 <button class="secondary" onclick="urge(${i})">I'm Tempted</button>
 <button class="secondary" onclick="slipped(${i})">I Slipped</button>
 <button class="danger" onclick="deleteHabit(${i})">Delete</button>

 <canvas id="chart${i}" width="300" height="100"></canvas>
 </div>
 `;
 });

 habits.forEach((h,i)=>{
 const c=document.getElementById("chart"+i);
 if(c) drawChart(c,h.history);
 });
}

render();
</script>
</body>
</html>
