<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">
<title>Daily Habits</title>

<style>
:root{
  --bg:#f2f2f7;
  --card:#ffffff;
  --text:#111;
  --accent:#4CAF50;
}

.dark{
  --bg:#1c1c1e;
  --card:#2c2c2e;
  --text:#f2f2f7;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont;
  background:var(--bg);
  color:var(--text);
  display:flex;
  justify-content:center;
}

.app{
  width:100%;
  max-width:480px;
  padding:20px;
}

.card{
  background:var(--card);
  padding:15px;
  border-radius:16px;
  margin-bottom:15px;
}

h2,h3{
  margin-top:0;
}

input,button,select{
  width:100%;
  box-sizing:border-box;
  padding:12px;
  border-radius:10px;
  border:none;
  margin:6px 0;
  font-size:16px;
}

button{
  background:var(--accent);
  color:white;
  font-weight:bold;
}

li{
  list-style:none;
  padding:10px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  border-bottom:1px solid #ccc3;
}

.checked span{
  text-decoration:line-through;
  opacity:.6;
}

.progress{
  height:10px;
  background:#ccc3;
  border-radius:10px;
  overflow:hidden;
}

.bar{
  height:100%;
  background:var(--accent);
  width:0%;
}
</style>
</head>

<body>
<div class="app">

<div class="card">
<h2>Daily Habits</h2>
<button onclick="toggleDark()">Toggle Dark Mode</button>
<h3 id="streak"></h3>
<h3 id="points"></h3>

<div class="progress">
<div class="bar" id="bar"></div>
</div>
</div>

<div class="card">
<h3>Good Habits</h3>
<input id="goodInput" placeholder="New habit/task">
<button onclick="addHabit('good')">Add</button>
<ul id="goodList"></ul>
</div>

<div class="card">
<h3>Habits To Avoid ðŸš«</h3>
<input id="badInput" placeholder="Habit you're avoiding today">
<button onclick="addHabit('bad')">Add</button>
<ul id="badList"></ul>
</div>

</div>

<script>
const GOOD="goodHabits";
const BAD="badHabits";
const STREAK="habitStreak";
const POINTS="habitPoints";

load();
updateStats();

/* -------- ADD HABITS -------- */
function addHabit(type){
  const input=document.getElementById(type+"Input");
  if(!input.value) return;

  createHabit(input.value,false,type);
  save();
  input.value="";
}

function createHabit(text,checked,type){
  const li=document.createElement("li");
  if(checked) li.classList.add("checked");

  li.innerHTML=`
    <span>${text}</span>
    <input type="checkbox" ${checked?"checked":""}>
  `;

  li.querySelector("input").onchange=()=>{
    li.classList.toggle("checked");
    updatePoints(type);
    save();
  };

  document.getElementById(type+"List").appendChild(li);
}

/* -------- SAVE/LOAD -------- */
function save(){
  const g=[...goodList.children].map(li=>({
    text:li.querySelector("span").textContent,
    checked:li.classList.contains("checked")
  }));

  const b=[...badList.children].map(li=>({
    text:li.querySelector("span").textContent,
    checked:li.classList.contains("checked")
  }));

  localStorage.setItem(GOOD,JSON.stringify(g));
  localStorage.setItem(BAD,JSON.stringify(b));
  updateStats();
}

function load(){
  JSON.parse(localStorage.getItem(GOOD)||"[]")
    .forEach(t=>createHabit(t.text,t.checked,"good"));

  JSON.parse(localStorage.getItem(BAD)||"[]")
    .forEach(t=>createHabit(t.text,t.checked,"bad"));
}

/* -------- GAMIFICATION -------- */
function updatePoints(type){
  let pts=parseInt(localStorage.getItem(POINTS)||0);

  pts += type==="good"?10:15;
  localStorage.setItem(POINTS,pts);
}

function updateStats(){
  const pts=localStorage.getItem(POINTS)||0;
  points.textContent="â­ Points: "+pts;

  const total=document.querySelectorAll("li").length;
  const done=document.querySelectorAll(".checked").length;

  bar.style.width=total?((done/total)*100)+"%":"0%";

  let streak=parseInt(localStorage.getItem(STREAK)||0);
  if(done===total && total>0){
    localStorage.setItem(STREAK,++streak);
  }
  streakEl.textContent="ðŸ”¥ Streak: "+streak+" days";
}

/* -------- DARK MODE -------- */
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode",
    document.body.classList.contains("dark"));
}

if(localStorage.getItem("darkMode")==="true"){
  document.body.classList.add("dark");
}

const streakEl=document.getElementById("streak");
const points=document.getElementById("points");
</script>
</body>
</html>
